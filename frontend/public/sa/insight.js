!function(){var w=window,d=document,cs=d.currentScript||function(){var s=d.getElementsByTagName('script');return s[s.length-1]}();var sid=(cs&&cs.getAttribute&&cs.getAttribute('data-site'))||"";if(!sid||!w||!d)return;var cfg={st:30,sm:200};try{cfg.st=parseInt(cs.getAttribute('data-session')||"30",10)||30}catch(e){}var LS=w.localStorage,SS=w.sessionStorage;function b64(u8){var s="",i=0;for(;i<u8.length;i++)s+=String.fromCharCode(u8[i]);return btoa(s).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'')}function rid(n){var a=new Uint8Array(n);(w.crypto||w.msCrypto).getRandomValues(a);return b64(a)}function getVid(){var k="sa_vid_"+sid;var v="";try{v=LS.getItem(k)||""}catch(e){}if(!v){v=rid(16);try{LS.setItem(k,v)}catch(e){}}return v}function getSess(){var k="sa_sess_"+sid,lk=k+"_last";var now=Date.now();var last=0;try{last=parseInt(SS.getItem(lk)||"0",10)||0}catch(e){}var ttl=cfg.st*60*1000;var s="";try{s=SS.getItem(k)||""}catch(e){}if(!s||!last||now-last>ttl){s=rid(12);try{SS.setItem(k,s)}catch(e){} }try{SS.setItem(lk,String(now))}catch(e){}return s}
function dev(){var ua=navigator.userAgent||"";var m=/Mobile|Android|iP(hone|od)/.test(ua),t=/iPad|Tablet/.test(ua);return t?"tablet":(m?"mobile":"desktop")}function os(){var ua=navigator.userAgent||"";if(/Windows/.test(ua))return"Windows";if(/Mac OS X/.test(ua)&&!/iPhone|iPad/.test(ua))return"macOS";if(/Android/.test(ua))return"Android";if(/iPhone|iPad|iPod/.test(ua))return"iOS";if(/Linux/.test(ua))return"Linux";return"Other"}function br(){var ua=navigator.userAgent||"";if(/Edg\//.test(ua))return"Edge";if(/Chrome\//.test(ua)&&!/Edg\//.test(ua))return"Chrome";if(/Firefox\//.test(ua))return"Firefox";if(/Safari\//.test(ua)&&!/Chrome\//.test(ua))return"Safari";return"Other"}
function tz(){try{return Intl.DateTimeFormat().resolvedOptions().timeZone||""}catch(e){return""}}function countryHint(tzv){var p=(tzv||"").split('/');return p.length>1?p[0]:""}
function channel(ref){try{if(!ref)return"Direct";var u=new URL(ref);var h=u.hostname||"";if(/(google\.|bing\.|duckduckgo\.)/.test(h))return"Search";if(/(facebook\.|twitter\.|x\.com|t\.co|instagram\.|linkedin\.|tiktok\.)/.test(h))return"Social";return"Referral"}catch(e){return ref?"Referral":"Direct"}}
function utm(){var q={};try{var p=new URLSearchParams(w.location.search);["utm_source","utm_medium","utm_campaign","utm_term","utm_content"].forEach(function(k){var v=p.get(k);if(v)q[k]=v})}catch(e){}return q}
var vid=getVid();var sess=getSess();var hitId="";var scrollMax=0;function send(kind,payload){try{if(!navigator.serviceWorker){return}var msg={kind:kind,payload:payload};if(navigator.serviceWorker.controller){navigator.serviceWorker.controller.postMessage(msg)}else{navigator.serviceWorker.ready.then(function(r){if(r&&r.active)r.active.postMessage(msg)})}}catch(e){}}
function sendHit(h){send("SA_HIT",h)}function patch(id,patchObj){try{if(!navigator.serviceWorker)return;var msg={kind:"SA_HIT_PATCH",id:id,patch:patchObj};if(navigator.serviceWorker.controller){navigator.serviceWorker.controller.postMessage(msg)}else{navigator.serviceWorker.ready.then(function(r){if(r&&r.active)r.active.postMessage(msg)})}}catch(e){}}
function pv(){sess=getSess();var now=Date.now();var tzv=tz();var u=utm();hitId=rid(10)+"_"+String(now);var h={id:hitId,siteId:sid,type:"pageview",ts:now,url:w.location.href,title:d.title||"",referrer:d.referrer||"",visitorId:vid,sessionId:sess,durationMs:null,scrollMax:null,deviceType:dev(),browser:br(),os:os(),lang:navigator.language||"",tz:tzv,countryHint:countryHint(tzv),channel:channel(d.referrer||""),eventName:null,eventProps:null,utm_source:u.utm_source||null,utm_medium:u.utm_medium||null,utm_campaign:u.utm_campaign||null,utm_term:u.utm_term||null,utm_content:u.utm_content||null};sendHit(h)}
function track(name,props){var now=Date.now();var tzv=tz();var h={id:rid(10)+"_"+String(now),siteId:sid,type:"event",ts:now,url:w.location.href,title:d.title||"",referrer:d.referrer||"",visitorId:vid,sessionId:getSess(),deviceType:dev(),browser:br(),os:os(),lang:navigator.language||"",tz:tzv,countryHint:countryHint(tzv),channel:channel(d.referrer||""),eventName:String(name||"event"),eventProps:props||null};sendHit(h)}
function outbound(url){var now=Date.now();var tzv=tz();var h={id:rid(10)+"_"+String(now),siteId:sid,type:"outbound",ts:now,url:w.location.href,title:d.title||"",referrer:d.referrer||"",visitorId:vid,sessionId:getSess(),deviceType:dev(),browser:br(),os:os(),lang:navigator.language||"",tz:tzv,countryHint:countryHint(tzv),channel:channel(d.referrer||""),eventName:"outbound",eventProps:{to:url}};sendHit(h)}
function onScroll(){var de=d.documentElement;var st=(w.pageYOffset||de.scrollTop||0);var h=de.scrollHeight-w.innerHeight;var p=h>0?Math.min(100,Math.round((st/h)*100)):100;if(p>scrollMax)scrollMax=p}
function onEnd(){try{var dur=Date.now()-parseInt(hitId.split('_')[1]||String(Date.now()),10);patch(hitId,{durationMs:dur,scrollMax:scrollMax})}catch(e){}}
function regSW(){try{if(!navigator.serviceWorker)return;var swUrl="/sw.js";navigator.serviceWorker.register(swUrl,{scope:"/"}).catch(function(){})}catch(e){}}
// SPA route changes
function hookHistory(){try{var ps=history.pushState,rs=history.replaceState;history.pushState=function(){ps.apply(history,arguments);setTimeout(pv,0)};history.replaceState=function(){rs.apply(history,arguments);setTimeout(pv,0)};w.addEventListener('popstate',function(){setTimeout(pv,0)})}catch(e){}}
// outbound clicks
function hookClicks(){d.addEventListener('click',function(e){try{var a=e.target&&e.target.closest?e.target.closest('a'):null;if(!a||!a.href)return;var u=new URL(a.href);if(u.host&&u.host!==w.location.host){outbound(a.href)}}catch(err){}},true)}

w.sa=w.sa||{};w.sa.track=track;w.sa.siteId=sid;
regSW();hookHistory();hookClicks();w.addEventListener('scroll',onScroll,{passive:true});w.addEventListener('visibilitychange',function(){if(d.visibilityState==='hidden')onEnd()});w.addEventListener('pagehide',onEnd);
pv();}();
